<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>MySQL学习笔记</title>
    <url>/2020/04/11/mysql%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h3 id="一、如何在终端上操作mysql数据库"><a href="#一、如何在终端上操作mysql数据库" class="headerlink" title="一、如何在终端上操作mysql数据库:"></a>一、如何在终端上操作mysql数据库:</h3><ol>
<li>开启数据库的两种方式</li>
</ol>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">net <span class="keyword">start</span> mysql</span><br><span class="line">mysql -u root -p</span><br><span class="line">或者mysql -u root -p<span class="string">"密码"</span>(之间不要空格)</span><br></pre></td></tr></table></figure>
<a id="more"></a>

<ol start="2">
<li>显示数据库<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">databases</span>;</span><br></pre></td></tr></table></figure></li>
<li>创建数据库<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> 数据库名;</span><br></pre></td></tr></table></figure></li>
<li>使用数据库<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> 数据库名;</span><br></pre></td></tr></table></figure></li>
<li>退出数据库<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">exit;</span><br></pre></td></tr></table></figure></li>
<li>删除数据库<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">database</span> 数据库名;</span><br></pre></td></tr></table></figure>
<hr>  

</li>
</ol>
<h3 id="二、对表的操作"><a href="#二、对表的操作" class="headerlink" title="二、对表的操作:"></a>二、对表的操作:</h3><ol>
<li>建表<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> pet(</span><br><span class="line">	<span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>),</span><br><span class="line">	sex <span class="built_in">varchar</span>(<span class="number">10</span>),</span><br><span class="line">	birth <span class="built_in">date</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure></li>
<li>查看创建的数据表结构<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">desc 表名;</span><br><span class="line">+<span class="comment">-------+------------+------+-----+---------+-------+</span></span><br><span class="line">| Field | Type       | Null | Key | Default | Extra |</span><br><span class="line">+<span class="comment">-------+------------+------+-----+---------+-------+</span></span><br><span class="line">| name  | varchar(5) | YES  |     | NULL    |       |</span><br><span class="line">| sex   | varchar(1) | YES  |     | NULL    |       |</span><br><span class="line">| birth | date       | YES  |     | NULL    |       |</span><br><span class="line">+<span class="comment">-------+------------+------+-----+---------+-------+</span></span><br></pre></td></tr></table></figure></li>
<li>删除表<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> 表名;</span><br></pre></td></tr></table></figure></li>
<li>显示表<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span>;</span><br></pre></td></tr></table></figure>
<hr>

</li>
</ol>
<h3 id="三、mysql常用语句："><a href="#三、mysql常用语句：" class="headerlink" title="三、mysql常用语句："></a>三、mysql常用语句：</h3><ol>
<li>insert语句<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> pet <span class="keyword">values</span>(<span class="string">'张三'</span>,<span class="string">'男'</span>,<span class="string">'2000-03-05'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> pet(<span class="keyword">name</span>,sex) <span class="keyword">values</span>(<span class="string">'李四'</span>,<span class="string">'男'</span>);</span><br></pre></td></tr></table></figure></li>
<li>delete语句<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> pet <span class="keyword">where</span> <span class="keyword">name</span>=’王五’;</span><br></pre></td></tr></table></figure></li>
<li>update语句<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">update</span> pet <span class="keyword">set</span> sex=’女’ <span class="keyword">where</span> <span class="keyword">name</span>=’李四’;</span><br></pre></td></tr></table></figure>
<hr>

</li>
</ol>
<h3 id="四、建表约束条件："><a href="#四、建表约束条件：" class="headerlink" title="四、建表约束条件："></a>四、建表约束条件：</h3><ol>
<li><p>主键约束，能够唯一确定一张表中的一条记录，给某字段添加使其不重复不为空</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">creat table ss(</span><br><span class="line">	id int primary key;</span><br><span class="line">	name varchar(10)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">creat table ss(</span><br><span class="line">	id in primary key,</span><br><span class="line">	name varchar(10),</span><br><span class="line">	psw varchar(10),</span><br><span class="line">	primary key(id,name)</span><br><span class="line">);</span><br><span class="line">//联合主键，只要联合的主键值加起来不重复就可以，不过里面任何字段不为空</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">creat table ss(</span><br><span class="line">	id int,</span><br><span class="line">	name varchar(10)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> ss <span class="keyword">add</span> primary <span class="keyword">key</span>(<span class="keyword">id</span>);</span><br><span class="line">//修改表结构添加主键</span><br></pre></td></tr></table></figure></li>
<li><p>外键约束，涉及两个表：父表（主表），子表（副表）</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">//班级（主表）</span><br><span class="line">creat table classes(</span><br><span class="line">	id int primary key,</span><br><span class="line">	name varchar(20)</span><br><span class="line">);</span><br><span class="line">//学生表（副表）,class_id为classes表的外键</span><br><span class="line">creat table students(</span><br><span class="line">	id int primary key,</span><br><span class="line">	name varchar(20),</span><br><span class="line">	class_id int ,</span><br><span class="line">	foreign key(class_id) references classes(id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">对上表进行插入操作</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> classes <span class="keyword">values</span> (<span class="number">1</span>,’<span class="number">1</span>班’);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> classes <span class="keyword">values</span> (<span class="number">2</span>,’<span class="number">2</span>班’);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> classes <span class="keyword">values</span> (<span class="number">3</span>,’<span class="number">3</span>班’);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> classes <span class="keyword">values</span> (<span class="number">4</span>,’<span class="number">4</span>班’);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students <span class="keyword">values</span>(<span class="number">1001</span>,’张三’,<span class="number">1</span>); </span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students <span class="keyword">values</span>(<span class="number">1002</span>,’李四’,<span class="number">5</span>);//出错，副表要参照主表，主表没有的副表不可以使用 </span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> classes <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">1</span>;//错误，主表的记录被副表应用时不可以被删除</span><br></pre></td></tr></table></figure>
</li>
<li><p>唯一约束</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">creat table ss(</span><br><span class="line">	id int,</span><br><span class="line">	name varchar(10)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> ss <span class="keyword">add</span> <span class="keyword">unique</span>(<span class="keyword">id</span>);//id不能重复</span><br><span class="line"></span><br><span class="line">creat table ss(</span><br><span class="line">	id int,</span><br><span class="line">	name varchar(10)</span><br><span class="line">	unique(id,name)//id,name组合不能重复</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
<li><p>非空约束</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">creat table ss(</span><br><span class="line">	id int not null,</span><br><span class="line">	name varchar(10)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
<li><p>默认约束</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">creat table ss(</span><br><span class="line">	id int ,</span><br><span class="line">	name varchar(10),</span><br><span class="line">	age int default 10//age开始默认为10，可以用新的插入顶替</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

</li>
</ol>
<hr>

<h3 id="五、数据库三大设计范式"><a href="#五、数据库三大设计范式" class="headerlink" title="五、数据库三大设计范式"></a>五、数据库三大设计范式</h3><ol>
<li><p>第一范式(1NF):数据表中的所有字段都是不可分割的原子值  </p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">+<span class="comment">----+--------+-----------------------------+</span></span><br><span class="line">| id | name   | address                     |</span><br><span class="line">+<span class="comment">----+--------+-----------------------------+</span></span><br><span class="line">|  1 | 张三   | 安徽省合肥市蜀山区          |</span><br><span class="line">|  2 | 李四   | 安徽省合肥市庐阳区          |</span><br><span class="line">|  3 | 王二   | 安徽省合肥市包河区          |</span><br><span class="line">+<span class="comment">----+--------+-----------------------------+</span></span><br><span class="line">address一列其实还是可以拆分的可以再分成省份、城市、区，上图就是可拆分，不满足第一范式；</span><br><span class="line">范式设计的越详细，对某些实际操作可能更好，但是不一定都是好处。</span><br></pre></td></tr></table></figure>
</li>
<li><p>第二范式(2NF):必须是满足第一范式的前提下，第二范式要求，除主键外每一列都必须完全依赖于主键</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">如果出现不完全依赖，只可能发生在联合主键的情况下</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> myorser(</span><br><span class="line">    product_id <span class="built_in">int</span>,           //产品号</span><br><span class="line">    customer_id <span class="built_in">int</span>,          //用户号</span><br><span class="line">    product_name <span class="built_in">varchar</span>(<span class="number">20</span>),</span><br><span class="line">    customer_name <span class="built_in">varchar</span>(<span class="number">20</span>),</span><br><span class="line">    primary <span class="keyword">key</span>(product_id,customer_id)//产品号和用户号形成联合主键</span><br><span class="line">);</span><br><span class="line">此表的产品的名只和产品号有关、用户的名只和用户号有关，就是不完全依赖于主键，不满足第二范式。</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>拆表如下满足第二范式：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> myorder2(     //订单表,包括产品号、用户号依赖于订单号</span><br><span class="line">	order_id <span class="built_in">int</span> primary <span class="keyword">key</span>,</span><br><span class="line">    product_id <span class="built_in">int</span>,</span><br><span class="line">    customer_id <span class="built_in">int</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> product(    //产品表，产品名依赖于产品<span class="keyword">id</span></span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span>,</span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> customer(   //用户表，用户名依赖于用户<span class="keyword">id</span></span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span>,</span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>第三范式(3NF):必须满足第二范式，除开主键列其他列之间不能有传递关系<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> myorder2(    </span><br><span class="line">    order_id <span class="built_in">int</span> primary <span class="keyword">key</span>,</span><br><span class="line">    product_id <span class="built_in">int</span>,</span><br><span class="line">    customer_id <span class="built_in">int</span>，</span><br><span class="line">	customer_phone <span class="built_in">varchar</span>(<span class="number">20</span>)</span><br><span class="line">);</span><br><span class="line">向订单表插入顾客手机号(customer_phone),可以发现customer_phone和order_id主键有关系，但是customer_phone还依赖于customer_id（除主键外的其他键）。  </span><br><span class="line">这就不满足第三范式了，应该将顾客的手机放入用户表中才满足第三范式。</span><br></pre></td></tr></table></figure>

</li>
</ol>
<hr>

<h3 id="六、以下查询练习题目需新建一个名为”school”的数据库："><a href="#六、以下查询练习题目需新建一个名为”school”的数据库：" class="headerlink" title="六、以下查询练习题目需新建一个名为”school”的数据库："></a>六、以下查询练习题目需新建一个名为”school”的数据库：</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">创建几个表：</span><br><span class="line"></span><br><span class="line">学生表（Student）：学号、姓名、性别、出生年月日、班级</span><br><span class="line">课程表（course）：课程号、课程名称、教师编号</span><br><span class="line">成绩表（score）　：学号、课程号、成绩</span><br><span class="line">教师表（teacher）：教师编号、教师性别、教师性别、出生年月日、职称、所在部门</span><br><span class="line"></span><br><span class="line">创建学生表:</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student(        </span><br><span class="line">    sno <span class="built_in">varchar</span>(<span class="number">20</span>) primary <span class="keyword">key</span>,</span><br><span class="line">    sname <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">    ssex <span class="built_in">varchar</span>(<span class="number">10</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">    sbirthday datetime,</span><br><span class="line">    <span class="keyword">class</span> <span class="built_in">varchar</span>(<span class="number">20</span>)</span><br><span class="line"> );</span><br><span class="line"></span><br><span class="line">创建老师表:</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> teacher(</span><br><span class="line">    tno <span class="built_in">varchar</span>(<span class="number">20</span>) primary <span class="keyword">key</span>,</span><br><span class="line">    tname <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">    tsex <span class="built_in">varchar</span>(<span class="number">10</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">    tbirthday datetime,</span><br><span class="line">    prof <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">    depart <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">创建课程表:</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> course(</span><br><span class="line">    cno <span class="built_in">varchar</span>(<span class="number">20</span>) primary <span class="keyword">key</span>,</span><br><span class="line">    cname <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">    tcno <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">    <span class="keyword">foreign</span> <span class="keyword">key</span>(tcno) <span class="keyword">references</span> teacher(tno) </span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">创建成绩表:</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> score(</span><br><span class="line">    ssno <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">    ccno <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">    degree <span class="built_in">decimal</span>,</span><br><span class="line">    <span class="keyword">foreign</span> <span class="keyword">key</span>(ssno) <span class="keyword">references</span> student(sno),</span><br><span class="line">    <span class="keyword">foreign</span> <span class="keyword">key</span>(ccno) <span class="keyword">references</span> course(cno),</span><br><span class="line">    primary <span class="keyword">key</span>(ssno,ccno) </span><br><span class="line"> );</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">使用<span class="keyword">insert</span>插入数据后：</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> student;</span><br><span class="line">+<span class="comment">-----+-----------+------+---------------------+-------+</span></span><br><span class="line">| sno | sname     | ssex | sbirthday           | class |</span><br><span class="line">+<span class="comment">-----+-----------+------+---------------------+-------+</span></span><br><span class="line">| 101 | 曾华      | 男   | 1977-09-01 00:00:00 | 95033 |</span><br><span class="line">| 102 | 匡明      | 男   | 1975-02-12 00:00:00 | 95031 |</span><br><span class="line">| 103 | 王丽      | 女   | 1976-01-23 00:00:00 | 95033 |</span><br><span class="line">| 104 | 李军      | 男   | 1976-02-20 00:00:00 | 95033 |</span><br><span class="line">| 105 | 王芳      | 女   | 1975-02-10 00:00:00 | 95031 |</span><br><span class="line">| 106 | 陆君      | 男   | 1974-06-03 00:00:00 | 95031 |</span><br><span class="line">| 107 | 王尼玛    | 男   | 1974-06-03 00:00:00 | 95033 |</span><br><span class="line">| 108 | 张全蛋    | 男   | 1974-03-13 00:00:00 | 95031 |</span><br><span class="line">| 109 | 赵铁柱    | 男   | 1974-06-03 00:00:00 | 95031 |</span><br><span class="line">+<span class="comment">-----+-----------+------+---------------------+-------+</span></span><br><span class="line"></span><br><span class="line">mysql&gt; select * from teacher;</span><br><span class="line">+<span class="comment">-----+--------+------+---------------------+-----------+-----------------+</span></span><br><span class="line">| tno | tname  | tsex | tbirthday           | prof      | depart          |</span><br><span class="line">+<span class="comment">-----+--------+------+---------------------+-----------+-----------------+</span></span><br><span class="line">| 804 | 李诚   | 男   | 1958-12-02 00:00:00 | 副教授    | 计算机系        |</span><br><span class="line">| 825 | 王萍   | 女   | 1972-05-05 00:00:00 | 助教      | 计算机系        |</span><br><span class="line">| 831 | 刘冰   | 女   | 1977-08-14 00:00:00 | 助教      | 电子工程系      |</span><br><span class="line">| 856 | 张旭   | 男   | 1969-03-12 00:00:00 | 讲师      | 电子工程系      |</span><br><span class="line">+<span class="comment">-----+--------+------+---------------------+-----------+-----------------+</span></span><br><span class="line"></span><br><span class="line">mysql&gt; select * from course;</span><br><span class="line">+<span class="comment">-------+-----------------+------+</span></span><br><span class="line">| cno   | cname           | tcno |</span><br><span class="line">+<span class="comment">-------+-----------------+------+</span></span><br><span class="line">| 3-105 | 计算机导论      | 825  |</span><br><span class="line">| 3-245 | 操作系统        | 804  |</span><br><span class="line">| 6-166 | 数字电路        | 856  |</span><br><span class="line">| 9-888 | 高等数学        | 831  |</span><br><span class="line">+<span class="comment">-------+-----------------+------+</span></span><br><span class="line"></span><br><span class="line">mysql&gt; select * from score;</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br><span class="line">| ssno | ccno  | degree |</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br><span class="line">| 101  | 3-105 |     66 |</span><br><span class="line">| 102  | 3-105 |     59 |</span><br><span class="line">| 103  | 3-105 |     92 |</span><br><span class="line">| 103  | 3-245 |     86 |</span><br><span class="line">| 103  | 6-166 |     85 |</span><br><span class="line">| 104  | 3-105 |     66 |</span><br><span class="line">| 105  | 3-105 |     88 |</span><br><span class="line">| 105  | 3-245 |     75 |</span><br><span class="line">| 105  | 6-166 |     79 |</span><br><span class="line">| 109  | 3-105 |     76 |</span><br><span class="line">| 109  | 3-245 |     68 |</span><br><span class="line">| 109  | 6-166 |     81 |</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br></pre></td></tr></table></figure>

<ol>
<li>查询不重复内容：<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql&gt; select distinct ssno from score;</span><br><span class="line">+<span class="comment">------+</span></span><br><span class="line">| ssno |</span><br><span class="line">+<span class="comment">------+</span></span><br><span class="line">| 101  |</span><br><span class="line">| 102  |</span><br><span class="line">| 103  |</span><br><span class="line">| 104  |</span><br><span class="line">| 105  |</span><br><span class="line">| 109  |</span><br><span class="line">+<span class="comment">------+</span></span><br></pre></td></tr></table></figure></li>
<li>查询区间：<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql&gt; select * from score where degree between 60 and 80;</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br><span class="line">| ssno | ccno  | degree |</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br><span class="line">| 101  | 3-105 |     66 |</span><br><span class="line">| 104  | 3-105 |     66 |</span><br><span class="line">| 105  | 3-245 |     75 |</span><br><span class="line">| 105  | 6-166 |     79 |</span><br><span class="line">| 109  | 3-105 |     76 |</span><br><span class="line">| 109  | 3-245 |     68 |</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br><span class="line"></span><br><span class="line">mysql&gt; select * from score where degree &gt; 60 and degree &lt; 80;</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br><span class="line">| ssno | ccno  | degree |</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br><span class="line">| 101  | 3-105 |     66 |</span><br><span class="line">| 104  | 3-105 |     66 |</span><br><span class="line">| 105  | 3-245 |     75 |</span><br><span class="line">| 105  | 6-166 |     79 |</span><br><span class="line">| 109  | 3-105 |     76 |</span><br><span class="line">| 109  | 3-245 |     68 |</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br></pre></td></tr></table></figure></li>
<li>查询score表分数为85、86或88的记录：<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql&gt; select * from score where degree in(85,86,88);</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br><span class="line">| ssno | ccno  | degree |</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br><span class="line">| 103  | 3-245 |     86 |</span><br><span class="line">| 103  | 6-166 |     85 |</span><br><span class="line">| 105  | 3-105 |     88 |</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br></pre></td></tr></table></figure></li>
<li>查询class为‘95031’，ssex为‘女’的记录<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql&gt; select * from student where class='95031' or ssex='女';</span><br><span class="line">+<span class="comment">-----+-----------+------+---------------------+-------+</span></span><br><span class="line">| sno | sname     | ssex | sbirthday           | class |</span><br><span class="line">+<span class="comment">-----+-----------+------+---------------------+-------+</span></span><br><span class="line">| 102 | 匡明      | 男   | 1975-02-12 00:00:00 | 95031 |</span><br><span class="line">| 103 | 王丽      | 女   | 1976-01-23 00:00:00 | 95033 |</span><br><span class="line">| 105 | 王芳      | 女   | 1975-02-10 00:00:00 | 95031 |</span><br><span class="line">| 106 | 陆君      | 男   | 1974-06-03 00:00:00 | 95031 |</span><br><span class="line">| 108 | 张全蛋    | 男   | 1974-03-13 00:00:00 | 95031 |</span><br><span class="line">| 109 | 赵铁柱    | 男   | 1974-06-03 00:00:00 | 95031 |</span><br><span class="line">+<span class="comment">-----+-----------+------+---------------------+-------+</span></span><br></pre></td></tr></table></figure></li>
<li>以class降序查询student表的所有记录<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">class</span> <span class="keyword">desc</span>;//降序</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">class</span> <span class="keyword">asc</span>;//升序</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">class</span>;//默认升序</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from student order by class;</span><br><span class="line">+<span class="comment">-----+-----------+------+---------------------+-------+</span></span><br><span class="line">| sno | sname     | ssex | sbirthday           | class |</span><br><span class="line">+<span class="comment">-----+-----------+------+---------------------+-------+</span></span><br><span class="line">| 102 | 匡明      | 男   | 1975-02-12 00:00:00 | 95031 |</span><br><span class="line">| 105 | 王芳      | 女   | 1975-02-10 00:00:00 | 95031 |</span><br><span class="line">| 106 | 陆君      | 男   | 1974-06-03 00:00:00 | 95031 |</span><br><span class="line">| 108 | 张全蛋    | 男   | 1974-03-13 00:00:00 | 95031 |</span><br><span class="line">| 109 | 赵铁柱    | 男   | 1974-06-03 00:00:00 | 95031 |</span><br><span class="line">| 101 | 曾华      | 男   | 1977-09-01 00:00:00 | 95033 |</span><br><span class="line">| 103 | 王丽      | 女   | 1976-01-23 00:00:00 | 95033 |</span><br><span class="line">| 104 | 李军      | 男   | 1976-02-20 00:00:00 | 95033 |</span><br><span class="line">| 107 | 王尼玛    | 男   | 1974-06-03 00:00:00 | 95033 |</span><br><span class="line">+<span class="comment">-----+-----------+------+---------------------+-------+</span></span><br></pre></td></tr></table></figure></li>
<li>以ccno升序，degree降序查询<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql&gt; select * from score order by ccno asc,degree desc;</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br><span class="line">| ssno | ccno  | degree |</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br><span class="line">| 103  | 3-105 |     92 |</span><br><span class="line">| 105  | 3-105 |     88 |</span><br><span class="line">| 109  | 3-105 |     76 |</span><br><span class="line">| 101  | 3-105 |     66 |</span><br><span class="line">| 104  | 3-105 |     66 |</span><br><span class="line">| 102  | 3-105 |     59 |</span><br><span class="line">| 103  | 3-245 |     86 |</span><br><span class="line">| 105  | 3-245 |     75 |</span><br><span class="line">| 109  | 3-245 |     68 |</span><br><span class="line">| 103  | 6-166 |     85 |</span><br><span class="line">| 109  | 6-166 |     81 |</span><br><span class="line">| 105  | 6-166 |     79 |</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br></pre></td></tr></table></figure></li>
<li>统计‘95031’班级的人数<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql&gt; select count(*) from student where class='95031';</span><br><span class="line">+<span class="comment">----------+</span></span><br><span class="line">| count(*) |</span><br><span class="line">+<span class="comment">----------+</span></span><br><span class="line">|        5 |</span><br><span class="line">+<span class="comment">----------+</span></span><br></pre></td></tr></table></figure></li>
<li>查询score表中最高分数的学生号和课程号<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> ssno,ccno <span class="keyword">from</span> score <span class="keyword">where</span> degree=(<span class="keyword">select</span> <span class="keyword">max</span>(degree) <span class="keyword">from</span> score);</span><br><span class="line"><span class="keyword">select</span> ssno,ccno <span class="keyword">from</span> score <span class="keyword">order</span> <span class="keyword">by</span> degree <span class="keyword">desc</span> <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>;//缺点是多个同样大的不确定</span><br><span class="line">//limit 第一个数字表示从多少开始，第二个数表示查多少个；先降序排列</span><br></pre></td></tr></table></figure></li>
<li>查找课程ccno=‘3-105’对应的平均成绩<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">avg</span>(degree) <span class="keyword">from</span> score <span class="keyword">where</span> ccno=<span class="string">'3-105'</span>;</span><br></pre></td></tr></table></figure></li>
<li>查找每门课程对应的平均成绩<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql&gt; select avg(degree) from score group by ccno;</span><br><span class="line">+<span class="comment">-------------+</span></span><br><span class="line">| avg(degree) |</span><br><span class="line">+<span class="comment">-------------+</span></span><br><span class="line">|     74.5000 |</span><br><span class="line">|     76.3333 |</span><br><span class="line">|     81.6667 |</span><br><span class="line">+<span class="comment">-------------+</span></span><br></pre></td></tr></table></figure></li>
<li>查找score 表中至少有2名学生选修的并以3开头的课程号<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">not like 模糊查询取反</span><br><span class="line">mysql&gt; select ccno from score group by ccno</span><br><span class="line">    -&gt; having count(ccno)&gt;=2 and ccno like '3%';</span><br><span class="line">+<span class="comment">-------+</span></span><br><span class="line">| ccno  |</span><br><span class="line">+<span class="comment">-------+</span></span><br><span class="line">| 3-105 |</span><br><span class="line">| 3-245 |</span><br><span class="line">+<span class="comment">-------+</span></span><br></pre></td></tr></table></figure></li>
<li>查找score 表中至少有2名学生选修的并以3开头的课程平均成绩<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql&gt; select ccno,avg(degree) from score group by ccno</span><br><span class="line">    -&gt; having count(ccno)&gt;=2 and ccno like '3%';</span><br><span class="line">+<span class="comment">-------+-------------+</span></span><br><span class="line">| ccno  | avg(degree) |</span><br><span class="line">+<span class="comment">-------+-------------+</span></span><br><span class="line">| 3-105 |     74.5000 |</span><br><span class="line">| 3-245 |     76.3333 |</span><br><span class="line">+<span class="comment">-------+-------------+</span></span><br></pre></td></tr></table></figure></li>
<li>查询所有同学的sname、cno和degree列<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> sname,ccno,degree <span class="keyword">from</span> student,score</span><br><span class="line">	<span class="keyword">where</span> student.sno=score.ssno;</span><br></pre></td></tr></table></figure></li>
<li>查询所有学生的sname，cname，degree列<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> sname,cname,degree <span class="keyword">from</span> student,course,score</span><br><span class="line">	<span class="keyword">where</span> student.sno=score.ssno </span><br><span class="line">		<span class="keyword">and</span> score.ccno=course.cno;</span><br></pre></td></tr></table></figure></li>
<li>查询‘95031’班学生每门课的平均成绩<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql&gt; select ccno,avg(degree) from score</span><br><span class="line">    -&gt; where ssno in(select sno from student</span><br><span class="line">    -&gt; where class='95031') group by ccno;</span><br><span class="line">+<span class="comment">-------+-------------+</span></span><br><span class="line">| ccno  | avg(degree) |</span><br><span class="line">+<span class="comment">-------+-------------+</span></span><br><span class="line">| 3-105 |     74.3333 |</span><br><span class="line">| 3-245 |     71.5000 |</span><br><span class="line">| 6-166 |     80.0000 |</span><br><span class="line">+<span class="comment">-------+-------------+</span></span><br></pre></td></tr></table></figure></li>
<li>查询和学号为108,101的同学同年出生的所有学生的sno,sname和sbirthday列<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql&gt; select sno,sname,sbirthday from student</span><br><span class="line">    -&gt; where year(sbirthday)</span><br><span class="line">    -&gt; in (select year(sbirthday) from student</span><br><span class="line">    -&gt; where sno in (108,101));</span><br><span class="line">+<span class="comment">-----+-----------+---------------------+</span></span><br><span class="line">| sno | sname     | sbirthday           |</span><br><span class="line">+<span class="comment">-----+-----------+---------------------+</span></span><br><span class="line">| 101 | 曾华      | 1977-09-01 00:00:00 |</span><br><span class="line">| 106 | 陆君      | 1974-06-03 00:00:00 |</span><br><span class="line">| 107 | 王尼玛    | 1974-06-03 00:00:00 |</span><br><span class="line">| 108 | 张全蛋    | 1974-03-13 00:00:00 |</span><br><span class="line">| 109 | 赵铁柱    | 1974-06-03 00:00:00 |</span><br><span class="line">+<span class="comment">-----+-----------+---------------------+</span></span><br></pre></td></tr></table></figure></li>
<li>查询‘张旭’教师任课的学生成绩<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> score</span><br><span class="line">	<span class="keyword">where</span> ccno =(<span class="keyword">select</span> cno <span class="keyword">from</span> course</span><br><span class="line">		<span class="keyword">where</span> tcno=(<span class="keyword">select</span> tno <span class="keyword">from</span> teacher</span><br><span class="line">			<span class="keyword">where</span> tname=<span class="string">'张旭'</span>));</span><br></pre></td></tr></table></figure></li>
<li>查询选修某课程的同学人数大于5人的教师的信息<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> teacher</span><br><span class="line">	<span class="keyword">where</span> tno=(<span class="keyword">select</span> tcno <span class="keyword">from</span> course </span><br><span class="line">		<span class="keyword">where</span> cno =(<span class="keyword">select</span> ccno <span class="keyword">from</span> score</span><br><span class="line">			<span class="keyword">group</span> <span class="keyword">by</span> ccno <span class="keyword">having</span> <span class="keyword">count</span>(*)&gt;<span class="number">5</span>));</span><br></pre></td></tr></table></figure></li>
<li>查询‘计算机系’和‘电子工程系’不同职称的教师的信息<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--union 求并集</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> teacher</span><br><span class="line"><span class="keyword">where</span> depart=<span class="string">'计算机系'</span></span><br><span class="line">	<span class="keyword">and</span> prof <span class="keyword">not</span> <span class="keyword">in</span>(<span class="keyword">select</span> prof <span class="keyword">from</span> teacher</span><br><span class="line">		<span class="keyword">where</span> depart=<span class="string">'电子工程系'</span>)</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> teacher</span><br><span class="line">	<span class="keyword">where</span> depart=<span class="string">'电子工程系'</span></span><br><span class="line">		<span class="keyword">and</span> prof <span class="keyword">not</span> <span class="keyword">in</span>(<span class="keyword">select</span> prof <span class="keyword">from</span> teacher</span><br><span class="line">			<span class="keyword">where</span> depart=<span class="string">'计算机系'</span>);</span><br></pre></td></tr></table></figure></li>
<li>查找选修编号为“3-105”课程且成绩至少高于选修编号为“3-245”的同学信息再按desc排序<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">至少（any 大于等于其中一个）</span><br><span class="line">mysql&gt; select * from score</span><br><span class="line">    -&gt; where ccno='3-105'</span><br><span class="line">    -&gt; and degree &gt; any(select degree from score</span><br><span class="line">    -&gt; where ccno='3-245') order by degree desc;</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br><span class="line">| ssno | ccno  | degree |</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br><span class="line">| 103  | 3-105 |     92 |</span><br><span class="line">| 105  | 3-105 |     88 |</span><br><span class="line">| 109  | 3-105 |     76 |</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br><span class="line"></span><br><span class="line">all 大于任何一个</span><br></pre></td></tr></table></figure></li>
<li>查询成绩比该课程平均成绩低的同学的信息<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--复制表数据做数据查询，可以看成对两个等于score表的a、b进行操作</span></span><br><span class="line">mysql&gt; select * from score a</span><br><span class="line">    -&gt; where degree &lt; (select avg(degree) from score b</span><br><span class="line">    -&gt; where a.ccno=b.ccno);</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br><span class="line">| ssno | ccno  | degree |</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br><span class="line">| 101  | 3-105 |     66 |</span><br><span class="line">| 102  | 3-105 |     59 |</span><br><span class="line">| 104  | 3-105 |     66 |</span><br><span class="line">| 105  | 3-245 |     75 |</span><br><span class="line">| 105  | 6-166 |     79 |</span><br><span class="line">| 109  | 3-245 |     68 |</span><br><span class="line">| 109  | 6-166 |     81 |</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br></pre></td></tr></table></figure></li>
<li>查询student表中每个学生的姓名年龄<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--year函数，now函数</span></span><br><span class="line"><span class="keyword">select</span> sname,<span class="keyword">year</span>(<span class="keyword">now</span>())-<span class="keyword">year</span>(sbirthday)</span><br><span class="line">	<span class="keyword">as</span> <span class="string">'age'</span> <span class="keyword">from</span> student;</span><br><span class="line"></span><br><span class="line">mysql&gt; select year(now());</span><br><span class="line">+<span class="comment">-------------+</span></span><br><span class="line">| year(now()) |</span><br><span class="line">+<span class="comment">-------------+</span></span><br><span class="line">|        2020 |</span><br><span class="line">+<span class="comment">-------------+</span></span><br></pre></td></tr></table></figure></li>
<li>查询student表中最大值和最小值的sbirthday日期值<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql&gt; select max(sbirthday) as '最大日期',min(sbirthday)</span><br><span class="line">    -&gt; as '最小日期' from student;</span><br><span class="line">+<span class="comment">---------------------+---------------------+</span></span><br><span class="line">| 最大日期            | 最小日期            |</span><br><span class="line">+<span class="comment">---------------------+---------------------+</span></span><br><span class="line">| 1977-09-01 00:00:00 | 1974-03-13 00:00:00 |</span><br><span class="line">+<span class="comment">---------------------+---------------------+</span></span><br><span class="line">as:给列改名</span><br></pre></td></tr></table></figure></li>
<li>查询班号和年龄从小到大的顺序查询student表中的全部内容<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">class</span> <span class="keyword">desc</span>,sbirthday;</span><br></pre></td></tr></table></figure></li>
<li>查询最高分同学的信息<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> score <span class="keyword">where</span> degree=(<span class="keyword">select</span> <span class="keyword">max</span>(degree) <span class="keyword">from</span> score);</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>好啦！到这里练习终于结束了。</p>
<hr>

<h3 id="七、SQL的四种连接查询-表在school数据库中"><a href="#七、SQL的四种连接查询-表在school数据库中" class="headerlink" title="七、SQL的四种连接查询(表在school数据库中)"></a>七、SQL的四种连接查询(表在school数据库中)</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--先建两个表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> person(</span><br><span class="line">	<span class="keyword">id</span> <span class="built_in">int</span>,</span><br><span class="line">	<span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>),</span><br><span class="line">	cardID <span class="built_in">int</span></span><br><span class="line">);</span><br><span class="line">+<span class="comment">------+--------+--------+</span></span><br><span class="line">| id   | name   | cardID |</span><br><span class="line">+<span class="comment">------+--------+--------+</span></span><br><span class="line">|    1 | 张三   |      1 |</span><br><span class="line">|    2 | 李四   |      3 |</span><br><span class="line">|    3 | 王五   |      6 |</span><br><span class="line">+<span class="comment">------+--------+--------+</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> card(</span><br><span class="line">	<span class="keyword">id</span> <span class="built_in">int</span>,</span><br><span class="line">	<span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>)</span><br><span class="line">);</span><br><span class="line">+<span class="comment">------+-----------+</span></span><br><span class="line">| id   | name      |</span><br><span class="line">+<span class="comment">------+-----------+</span></span><br><span class="line">|    1 | 饭卡      |</span><br><span class="line">|    2 | 建行卡    |</span><br><span class="line">|    3 | 农行卡    |</span><br><span class="line">|    4 | 工商卡    |</span><br><span class="line">|    5 | 邮政卡    |</span><br><span class="line">+<span class="comment">------+-----------+</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--未创建外键</span></span><br></pre></td></tr></table></figure>
<ol>
<li><p>inner join查询（内连接）</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> person <span class="keyword">inner</span> <span class="keyword">join</span> card <span class="keyword">on</span> person.cardID=card.id;</span><br><span class="line"></span><br><span class="line">//inner可以去掉</span><br><span class="line">+<span class="comment">------+--------+--------+------+-----------+</span></span><br><span class="line">| id   | name   | cardID | id   | name      |</span><br><span class="line">+<span class="comment">------+--------+--------+------+-----------+</span></span><br><span class="line">|    1 | 张三   |      1 |    1 | 饭卡      |</span><br><span class="line">|    2 | 李四   |      3 |    3 | 农行卡    |</span><br><span class="line">+<span class="comment">------+--------+--------+------+-----------+</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--内联查询，其实就是两张表的数据通过某个字段相对查询出记录数据</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>left join（左外连接）</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> person <span class="keyword">left</span> <span class="keyword">join</span> card <span class="keyword">on</span> person.cardID=card.id;</span><br><span class="line"></span><br><span class="line">+<span class="comment">------+--------+--------+------+-----------+</span></span><br><span class="line">| id   | name   | cardID | id   | name      |</span><br><span class="line">+<span class="comment">------+--------+--------+------+-----------+</span></span><br><span class="line">|    1 | 张三   |      1 |    1 | 饭卡      |</span><br><span class="line">|    2 | 李四   |      3 |    3 | 农行卡    |</span><br><span class="line">|    3 | 王五   |      6 | NULL | NULL      |</span><br><span class="line">+<span class="comment">------+--------+--------+------+-----------+</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--左外连接会把表中所有数据取出来，如果有相等就显示出来</span></span><br><span class="line"><span class="comment">--没有，就会补 NULL</span></span><br></pre></td></tr></table></figure></li>
<li><p>right join（右外连接）</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> person <span class="keyword">right</span> <span class="keyword">join</span> card <span class="keyword">on</span> person.cardID=card.id;</span><br><span class="line"></span><br><span class="line">+<span class="comment">------+--------+--------+------+-----------+</span></span><br><span class="line">| id   | name   | cardID | id   | name      |</span><br><span class="line">+<span class="comment">------+--------+--------+------+-----------+</span></span><br><span class="line">|    1 | 张三   |      1 |    1 | 饭卡      |</span><br><span class="line">|    2 | 李四   |      3 |    3 | 农行卡    |</span><br><span class="line">| NULL | NULL   |   NULL |    2 | 建行卡    |</span><br><span class="line">| NULL | NULL   |   NULL |    4 | 工商卡    |</span><br><span class="line">| NULL | NULL   |   NULL |    5 | 邮政卡    |</span><br><span class="line">+<span class="comment">------+--------+--------+------+-----------+</span></span><br></pre></td></tr></table></figure></li>
<li><p>full jion(全外连接)</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--mysql 不支持 full join</span></span><br><span class="line"></span><br><span class="line">以下连接得到全连接</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> person <span class="keyword">left</span> <span class="keyword">join</span> card <span class="keyword">on</span> person.cardID=card.id</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> person <span class="keyword">right</span> <span class="keyword">join</span> card <span class="keyword">on</span> person.cardID=card.id;</span><br><span class="line"></span><br><span class="line">+<span class="comment">------+--------+--------+------+-----------+</span></span><br><span class="line">| id   | name   | cardID | id   | name      |</span><br><span class="line">+<span class="comment">------+--------+--------+------+-----------+</span></span><br><span class="line">|    1 | 张三   |      1 |    1 | 饭卡      |</span><br><span class="line">|    2 | 李四   |      3 |    3 | 农行卡    |</span><br><span class="line">|    3 | 王五   |      6 | NULL | NULL      |</span><br><span class="line">| NULL | NULL   |   NULL |    2 | 建行卡    |</span><br><span class="line">| NULL | NULL   |   NULL |    4 | 工商卡    |</span><br><span class="line">| NULL | NULL   |   NULL |    5 | 邮政卡    |</span><br><span class="line">+<span class="comment">------+--------+--------+------+-----------+</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
]]></content>
      <categories>
        <category>数据库</category>
      </categories>
      <tags>
        <tag>mysql</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2020/04/06/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<a id="more"></a>

<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p>
]]></content>
      <categories>
        <category>hexo简单用法</category>
      </categories>
      <tags>
        <tag>标签1</tag>
      </tags>
  </entry>
  <entry>
    <title>MyBatis入门</title>
    <url>/2021/04/04/MyBatis%E5%85%A5%E9%97%A8/</url>
    <content><![CDATA[<h3 id="一、简介"><a href="#一、简介" class="headerlink" title="一、简介"></a>一、简介</h3><h4 id="1、什么是-MyBatis？"><a href="#1、什么是-MyBatis？" class="headerlink" title="1、什么是 MyBatis？"></a>1、什么是 MyBatis？</h4><ul>
<li><p>MyBatis 是一款优秀的<strong>持久层框架</strong></p>
</li>
<li><p>MyBatis 避免了几乎所有的 JDBC 代码和手动设置参数以及获取结果集的过程</p>
</li>
<li><p>MyBatis 可以使用简单的 XML 或注解来配置和映射原生信息，将接口和 Java 的 实体类 【Plain Old Java Objects,普通的 Java对象】映射成数据库中的记录。</p>
</li>
<li><p>MyBatis 本是apache的一个开源项目ibatis, 2010年这个项目由apache 迁移到了google code，并且改名为MyBatis 。</p>
</li>
<li><p>2013年11月迁移到Github .</p>
</li>
<li><p>Mybatis官方文档 : <a href="http://www.mybatis.org/mybatis-3/zh/index.html" target="_blank" rel="noopener">http://www.mybatis.org/mybatis-3/zh/index.html</a></p>
</li>
<li><p>GitHub : <a href="https://github.com/mybatis/mybatis-3" target="_blank" rel="noopener">https://github.com/mybatis/mybatis-3</a></p>
</li>
</ul>
<h4 id="2、持久化"><a href="#2、持久化" class="headerlink" title="2、持久化"></a>2、持久化</h4><p><strong>持久化是将程序数据在持久状态和瞬时状态间转换的机制。</strong></p>
<ul>
<li><p>即把数据（如内存中的对象）保存到可永久保存的存储设备中（如磁盘）。持久化的主要应用是将内存中的对象存储在数据库中，或者存储在磁盘文件中、XML数据文件中等等。</p>
</li>
<li><p>JDBC就是一种持久化机制。文件IO也是一种持久化机制。</p>
</li>
<li><p>在生活中 : 将鲜肉冷藏，吃的时候再解冻的方法也是。将水果做成罐头的方法也是。</p>
</li>
</ul>
<p><strong>为什么需要持久化服务呢？那是由于内存本身的缺陷引起的</strong></p>
<ul>
<li><p>内存断电后数据会丢失，但有一些对象是无论如何都不能丢失的，比如银行账号等，遗憾的是，人们还无法保证内存永不掉电。</p>
</li>
<li><p>内存过于昂贵，与硬盘、光盘等外存相比，内存的价格要高2~3个数量级，而且维持成本也高，至少需要一直供电吧。所以即使对象不需要永久保存，也会因为内存的容量限制不能一直呆在内存中，需要持久化来缓存到外存。</p>
</li>
</ul>
<h4 id="3、持久层"><a href="#3、持久层" class="headerlink" title="3、持久层"></a>3、持久层</h4><p><strong>什么是持久层？</strong></p>
<ul>
<li><p>完成持久化工作的代码块 .  —-&gt;  dao层 【DAO (Data Access Object)  数据访问对象】</p>
</li>
<li><p>大多数情况下特别是企业级应用，数据持久化往往也就意味着将内存中的数据保存到磁盘上加以固化，而持久化的实现过程则大多通过各种<strong>关系数据库</strong>来完成。</p>
</li>
<li><p>不过这里有一个字需要特别强调，也就是所谓的“层”。对于应用系统而言，数据持久功能大多是必不可少的组成部分。也就是说，我们的系统中，已经天然的具备了“持久层”概念？也许是，但也许实际情况并非如此。之所以要独立出一个“持久层”的概念,而不是“持久模块”，“持久单元”，也就意味着，我们的系统架构中，应该有一个相对独立的逻辑层面，专注于数据持久化逻辑的实现.</p>
</li>
<li><p>与系统其他部分相对而言，这个层面应该具有一个较为清晰和严格的逻辑边界。【说白了就是用来操作数据库存在的！】</p>
</li>
</ul>
<h4 id="4、为什么需要Mybatis"><a href="#4、为什么需要Mybatis" class="headerlink" title="4、为什么需要Mybatis"></a>4、为什么需要Mybatis</h4><ul>
<li><p>Mybatis就是帮助程序猿将数据存入数据库中 , 和从数据库中取数据 .</p>
</li>
<li><p>传统的jdbc操作 , 有很多重复代码块 .比如 : 数据取出时的封装 , 数据库的建立连接等等… , 通过框架可以减少重复代码,提高开发效率 .</p>
</li>
<li><p>MyBatis 是一个半自动化的<strong>ORM框架 (Object Relationship Mapping) –&gt;对象关系映射</strong></p>
</li>
<li><p>所有的事情，不用Mybatis依旧可以做到，只是用了它，所有实现会更加简单！技术没有高低之分，只有使用这个技术的人有高低之别</p>
</li>
<li><p>MyBatis的优点</p>
<ul>
<li><p>简单易学：本身就很小且简单。没有任何第三方依赖，最简单安装只要两个jar文件+配置几个sql映射文件就可以了，易于学习，易于使用，通过文档和源代码，可以比较完全的掌握它的设计思路和实现。</p>
</li>
<li><p>灵活：mybatis不会对应用程序或者数据库的现有设计强加任何影响。sql写在xml里，便于统一管理和优化。通过sql语句可以满足操作数据库的所有需求。</p>
</li>
<li><p>解除sql与程序代码的耦合：通过提供DAO层，将业务逻辑和数据访问逻辑分离，使系统的设计更清晰，更易维护，更易单元测试。sql和代码的分离，提高了可维护性。</p>
</li>
<li><p>提供xml标签，支持编写动态sql。</p>
</li>
<li><p>…….</p>
</li>
<li><p>最重要的一点，使用的人多！公司需要！</p>
<h4 id="4、我的环境"><a href="#4、我的环境" class="headerlink" title="4、我的环境"></a>4、我的环境</h4></li>
</ul>
</li>
<li><p>jdk 8 +</p>
</li>
<li><p>MySQL 5.7.28</p>
</li>
<li><p>maven-3.6.1</p>
</li>
<li><p>IDEA</p>
</li>
</ul>
<h3 id="二、MyBatis第一个程序"><a href="#二、MyBatis第一个程序" class="headerlink" title="二、MyBatis第一个程序"></a>二、MyBatis第一个程序</h3><h4 id="1、搭建实验数据库"><a href="#1、搭建实验数据库" class="headerlink" title="1、搭建实验数据库"></a>1、搭建实验数据库</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> mybatis;</span><br><span class="line"><span class="keyword">use</span> mybatis;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">user</span>(</span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">int</span>(<span class="number">20</span>) primary <span class="keyword">key</span>,</span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>),</span><br><span class="line">    pwd <span class="built_in">varchar</span>(<span class="number">20</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">user</span> <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">'张三'</span>,<span class="string">'12345'</span>),(<span class="number">2</span>,<span class="string">'李四'</span>,<span class="string">'11111'</span>),(<span class="number">3</span>,<span class="string">'王五'</span>,<span class="string">'22222'</span>);</span><br></pre></td></tr></table></figure>


<h4 id="2、导入MyBatis相关-jar-包-pom-xml"><a href="#2、导入MyBatis相关-jar-包-pom-xml" class="headerlink" title="2、导入MyBatis相关 jar 包(pom.xml)"></a>2、导入MyBatis相关 jar 包(pom.xml)</h4><p>要使用 MyBatis， 只需将 mybatis-x.x.x.jar 文件置于类路径（classpath）中即可。<br>如果使用 Maven 来构建项目，则需将下面的依赖代码置于 pom.xml 文件中：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="3、编写MyBatis核心配置文件"><a href="#3、编写MyBatis核心配置文件" class="headerlink" title="3、编写MyBatis核心配置文件"></a>3、编写MyBatis核心配置文件</h4><ul>
<li>mybatis-config.xml文件</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--核心配置文件--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--映入外部配置文件,这些属性可以在外部进行配置，并可以进行动态替换。</span></span><br><span class="line"><span class="comment">    你既可以在典型的 Java 属性文件中配置这些属性，也可以在 properties 元素的子元素中设置:</span></span><br><span class="line"><span class="comment">        &lt;properties resource="db.properties"&gt;</span></span><br><span class="line"><span class="comment">            &lt;property name="username" value="root"/&gt;</span></span><br><span class="line"><span class="comment">            &lt;property name="password" value="4315853"/&gt;</span></span><br><span class="line"><span class="comment">        &lt;/properties&gt;</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"db.properties"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--类型别名可为 Java 类型设置一个缩写名字,第一种方式（名字顺便取）,实体类少使用</span></span><br><span class="line"><span class="comment">        &lt;typeAliases&gt;</span></span><br><span class="line"><span class="comment">            &lt;typeAlias type="com.Xie.pojo.User" alias="User"/&gt;</span></span><br><span class="line"><span class="comment">        &lt;/typeAliases&gt;</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--上述第二种方式，实体类多使用,也可以指定一个包名，MyBatis 会在包名下面搜索需要的 Java Bean,</span></span><br><span class="line"><span class="comment">    在没有注解的情况下，会使用 Bean 的首字母小写的非限定类名来作为它的别名--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.Xie.pojo"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"$&#123;driver&#125;"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;url&#125;"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;username&#125;"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;password&#125;"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--每一个Mapper.xml都需要在Mybatis核心配置文件中注册--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/Xie/dao/UserMapper.xml"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>db.properties文件</li>
</ul>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">driver</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql://localhost:3306/mybatis?useSSL=false&amp;useUnicode=true&amp;characterEncoding=UTF-8</span></span><br><span class="line"><span class="attr">username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">4315853</span></span><br></pre></td></tr></table></figure>
<h4 id="4、编写MyBatis工具类"><a href="#4、编写MyBatis工具类" class="headerlink" title="4、编写MyBatis工具类"></a>4、编写MyBatis工具类</h4><ul>
<li>在com.Xie.utils包下新建MybatisUtils类</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.Xie.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisUtils</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> SqlSessionFactory sqlSessionFactory;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">//使用mybatis获取sqlSessionFactory对象</span></span><br><span class="line">            String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">            InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">            sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        &#125; <span class="keyword">catch</span>(IOException e)&#123;</span><br><span class="line">            e.getStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlSession <span class="title">getSqlSession</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sqlSessionFactory.openSession();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="5、创建实体类"><a href="#5、创建实体类" class="headerlink" title="5、创建实体类"></a>5、创建实体类</h4><ul>
<li>在com.Xie.pojo包下新建User类</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.Xie.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String pwd;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span></span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(<span class="keyword">int</span> id, String name, String pwd)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.pwd = pwd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPwd</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> pwd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPwd</span><span class="params">(String pwd)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.pwd = pwd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"User&#123;"</span> +</span><br><span class="line">                <span class="string">"id="</span> + id +</span><br><span class="line">                <span class="string">", name='"</span> + name + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", pwd='"</span> + pwd + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="6、编写Mapper接口类"><a href="#6、编写Mapper接口类" class="headerlink" title="6、编写Mapper接口类"></a>6、编写Mapper接口类</h4><ul>
<li>在com.Xie.dao包下新建UserMapper类</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.Xie.pojo.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line">    <span class="comment">//查询全部用户</span></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">getUserList</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//根据id查询用户</span></span><br><span class="line">    <span class="function">User <span class="title">getUserById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">    <span class="comment">//增加用户</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">addUser</span><span class="params">(User user)</span></span>;</span><br><span class="line">    <span class="comment">//修改用户</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">UpdateUser</span><span class="params">(User user)</span></span>;</span><br><span class="line">    <span class="comment">//删除用户</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">DeleteUser</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="7、编写Mapper-xml配置文件"><a href="#7、编写Mapper-xml配置文件" class="headerlink" title="7、编写Mapper.xml配置文件"></a>7、编写Mapper.xml配置文件</h4><ul>
<li>在com.Xie.dao包下新建UserMapper.xml，由于该xml是未建在工程指定的resources位置下为了便于程序运行时能够找到指定的配置文件需要在pom.xml下添加如下代码：</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--在build中配置resource，来防止我们资源导出失败的问题--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>UserMapper.xml代码如下：</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    namespace中文意思：命名空间，作用如下：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    namespace的命名必须跟某个接口同名</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    接口中的方法与映射文件中sql语句id应该一一对应</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    namespace和子元素的id联合保证唯一  , 区别不同的mapper</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    绑定DAO接口</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    namespace命名规则 : 包名+类名</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.Xie.dao.UserMapper"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserList"</span> <span class="attr">resultType</span>=<span class="string">"user"</span>&gt;</span></span><br><span class="line">        select * from mybatis.user</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserById"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultType</span>=<span class="string">"com.Xie.pojo.User"</span>&gt;</span></span><br><span class="line">        select * from mybatis.user where id=#&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addUser"</span> <span class="attr">parameterType</span>=<span class="string">"com.Xie.pojo.User"</span>&gt;</span></span><br><span class="line">        insert into mybatis.user(id, name, pwd) values (#&#123;id&#125;,#&#123;name&#125;,#&#123;pwd&#125;);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"UpdateUser"</span> <span class="attr">parameterType</span>=<span class="string">"com.Xie.pojo.User"</span>&gt;</span></span><br><span class="line">        update mybatis.user set name=#&#123;name&#125;,pwd=#&#123;pwd&#125; where id=#&#123;id&#125;;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"DeleteUser"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span>&gt;</span></span><br><span class="line">        delete from mybatis.user where id=#&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="8、编写测试类"><a href="#8、编写测试类" class="headerlink" title="8、编写测试类"></a>8、编写测试类</h4><ul>
<li>Junit 包测试</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.Xie.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.Xie.pojo.User;</span><br><span class="line"><span class="keyword">import</span> com.Xie.utils.MybatisUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserMapperTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">        SqlSession sqlSession=MybatisUtils.getSqlSession();</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            UserMapper userMapper =sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">            List&lt;User&gt; userList= userMapper.getUserList();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span>(User user: userList)&#123;</span><br><span class="line">                System.out.println(user);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.getStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            sqlSession.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getUserById</span><span class="params">()</span></span>&#123;</span><br><span class="line">        SqlSession sqlSession=MybatisUtils.getSqlSession();</span><br><span class="line">        UserMapper mapper=sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        User user=mapper.getUserById(<span class="number">1</span>);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addUser</span><span class="params">()</span></span>&#123;</span><br><span class="line">        SqlSession sqlSession=MybatisUtils.getSqlSession();</span><br><span class="line">        UserMapper mapper=sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        <span class="keyword">int</span> res=mapper.addUser(<span class="keyword">new</span> User(<span class="number">4</span>,<span class="string">"谢沅峰"</span>,<span class="string">"55555"</span>));</span><br><span class="line">        <span class="keyword">if</span>(res&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">"插入成功！"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//增删改需要提交事务</span></span><br><span class="line">        sqlSession.commit();</span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">UpdateUser</span><span class="params">()</span></span>&#123;</span><br><span class="line">        SqlSession sqlSession=MybatisUtils.getSqlSession();</span><br><span class="line">        UserMapper mapper=sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        mapper.UpdateUser(<span class="keyword">new</span> User(<span class="number">1</span>,<span class="string">"张三"</span>,<span class="string">"12345"</span>));</span><br><span class="line">        sqlSession.commit();</span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">DeleteUser</span><span class="params">()</span></span>&#123;</span><br><span class="line">        SqlSession sqlSession=MybatisUtils.getSqlSession();</span><br><span class="line">        UserMapper mapper=sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        mapper.DeleteUser(<span class="number">4</span>);</span><br><span class="line">        sqlSession.commit();</span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Mybatis框架</category>
      </categories>
      <tags>
        <tag>MyBatis</tag>
      </tags>
  </entry>
  <entry>
    <title>Mybatis_SQL执行流程分析（源码）</title>
    <url>/2020/04/28/MyBatis_SQL%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<p>最近在学习mybatis框架，想要了解一下该框架究竟是如何执行sql的，可能是第一次看源码的缘故，一开始晕头转向的，不过在网上找到了一篇不错的博客，讲的很仔细：<a href="https://www.cnblogs.com/dongying/p/4142476.html" target="_blank" rel="noopener">深入浅出Mybatis系列（十）—SQL执行流程分析（源码篇）</a>. </p>
]]></content>
      <categories>
        <category>Mybatis框架</category>
      </categories>
      <tags>
        <tag>sql</tag>
        <tag>Mybatis</tag>
      </tags>
  </entry>
</search>
